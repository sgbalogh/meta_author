<h3>Create a new record:</h3>

<div id="map">
  <script>

      var map = L.map('map').setView([0,0], 10);

      var featureGroup = L.featureGroup().addTo(map);

      L.tileLayer('https://cartodb-basemaps-{s}.global.ssl.fastly.net/light_all/{z}/{x}/{y}.png', {
          attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, &copy; <a href="http://cartodb.com/attributions">CartoDB</a>',
          maxZoom: 18,
          detectRetina: true,
      }).addTo(map);

      var preview = L.tileLayer.wms('https://maps-public.geo.nyu.edu/geoserver/sdr/wms', {
          layers: 'sdr:nyu_2451_33888',
          format: 'image/png',
          transparent: true,
          detectRetina: true,
      }).addTo(map);

      var drawControl = new L.Control.Draw({
          edit: {
              featureGroup: featureGroup
          }
      }).addTo(map);

      map.on('draw:created', function(e) {
          featureGroup.addLayer(e.layer);
          console.log(e);
          if (e.layerType == "rectangle") {
              S = e.layer._latlngs[0].lat;
              W = e.layer._latlngs[0].lng;
              N = e.layer._latlngs[1].lat;
              E = e.layer._latlngs[2].lng;
              console.log(N + " " + S + " " + E + " " + W);
              document.getElementById("solr_geom").value = "ENVELOPE(" + W + ", " + E + ", " + N + ", " + S + ")";
          }



      });


  </script>
</div>


<div class="row">
<div class="col-md-5 col-md-offset-0">

  <%= form_for(@record) do |form| %>

      <%= form.label 'Metadata Schema', class: "form_id" %>
      <%= form.select :schema, ['GeoBlacklight', 'ISO 19119', 'FGDC'], {}, { class: 'form-control'} %>

      <%= form.label 'Unique Identifier (UUID)', class: "form_id" %>
      <%= form.text_field :uuid, class: 'form-control' %>

      <%= form.label 'Title', class: "form_id"  %>
      <%= form.text_field :dc_title_s, class: 'form-control' %>

      <%= form.label 'Description', class: "form_id"  %>
      <%= form.text_field :dc_description_s, class: 'form-control' %>

      <%= form.label 'Creator', class: "form_id"  %>
      <%= form.text_field :dc_creator_sm, class: 'form-control', multiple: true, 'data-role'=>'tagsinput' %>

      <%= form.label 'Rights', class: "form_id"  %>
      <%= form.select :dc_rights_s, ['Restricted', 'Public'], {}, { class: 'form-control'} %>

      <%= form.label 'Provenance', class: "form_id"  %><br>
      <%= form.text_field :dct_provenance_s, class: 'form-control', placeholder: current_user.institution, 'data-role'=>'tagsinput' %><br>

      <%= form.label 'References', class: "form_id"  %>
      <%= form.text_field :dct_references_s, class: 'form-control' %>

      <%= form.label 'GeoRSS Bounding Box', class: "form_id"  %>
      <%= form.text_field :georss_box_s, class: 'form-control' %>

      <%= form.label 'Layer ID', class: "form_id"  %>
      <%= form.text_field :layer_id_s, class: 'form-control' %>

      <%= form.label 'Geometry Type', class: "form_id"  %>
      <%= form.select :layer_geom_type_s, ['Point', 'Line', 'Polygon'], {}, { class: 'form-control'} %>

      <%= form.label 'Layer Slug', class: "form_id"  %>
      <%= form.text_field :layer_slug_s, class: 'form-control' %>

      <%= form.label 'Solr Bounding Box', class: "form_id"  %>
      <%= form.text_field :solr_geom, class: 'form-control', id: "solr_geom" %>



      <%= form.label 'Solr Year', class: "form_id"  %>
      <%= form.text_field :solr_year_i, class: 'form-control' %>





      <%= form.submit "Create record", class: "btn btn-primary" %>
  <% end %>




</div>
    </div>